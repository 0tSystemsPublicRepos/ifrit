{
  "server": {
    "listen_addr": ":8080",
    "api_listen_addr": ":8443",
    "proxy_target": "http://localhost:80",
    "multi_app_mode": false,
    "app_id_header": "X-App-ID",
    "app_id_fallback": "default",
    "apps": {
      "app1": {
        "proxy_target": "http://localhost:3000",
        "enabled": true,
        "description": "Main API"
      },
      "app2": {
        "proxy_target": "http://localhost:4000",
        "enabled": true,
        "description": "Admin Panel"
      }
    }
  },

  "database": {
    "type": "sqlite",
    "sqlite": {
      "path": "./data/ifrit.db",
      "journal_mode": "WAL",
      "synchronous": "NORMAL"
    }
  },

  "system": {
    "home_dir": "./",
    "log_dir": "./logs",
    "log_level": "info",
    "debug": false,
    "log_rotation": {
      "max_size_mb": 1,
      "max_backups": 3,
      "max_age_days": 30
    }
  },

  "llm": {
    "primary": "claude",
    "claude": {
      "api_key": "sk-ant-PUT_YOUR_API_KEY_HERE",
      "model": "claude-3-5-haiku-20241022"
    },
    "gemini": {
      "api_key": "PUT_YOUR_GEMINI_KEY_HERE",
      "model": "gemini-2.5-flash"
    }
  },

  "detection": {
    "mode": "detection",
    "enable_llm": false,
    "llm_only_on": ["GET", "POST", "PUT", "DELETE"],
    "enable_local_rules": true,
    "enable_db_patterns": true,
    "whitelist_ips": [],
    "whitelist_paths": [],
    "skip_body_check_on_whitelist": false
  },

  "anonymization": {
    "enabled": false,
    "strategy": "hybrid",
    "store_original": true,
    "sensitive_headers": ["Authorization", "Cookie", "X-API-Key", "X-Auth-Token"]
  },

  "execution_mode": {
    "mode": "detection",
    "onboarding_auto_whitelist": true,
    "onboarding_duration_days": 7,
    "onboarding_log_file": "./logs/onboarding_traffic.log"
  },

  "payload_management": {
    "use_db_payloads": true,
    "generate_dynamic_payload": false,
    "cache_llm_payloads_to_db": true,
    "intel_collection_payload_id": 1,
    "default_responses": {
      "reconnaissance": {
        "content": {"error": "Not found"},
        "status_code": 404
      },
      "sql_injection": {
        "content": {"error": "Forbidden"},
        "status_code": 403
      },
      "xss": {
        "content": {"error": "Invalid input", "message": "XSS prevention enabled"},
        "status_code": 400
      },
      "credential_stuffing": {
        "content": {"error": "Invalid credentials", "message": "Account locked after 3 attempts"},
        "status_code": 401
      },
      "blocked_by_allowlist": {
        "content": {"error": "Forbidden"},
        "status_code": 403
      },
      "fallback": {
        "content": {"error": "Internal server error"},
        "status_code": 500
      }
    }
  },

  "threat_intelligence": {
    "enabled": false,
    "cache_ttl_hours": 24,
    "enrichment_workers": 3,
    "apis": {
      "abuseipdb": {
        "enabled": false,
        "api_key": "PUT_YOUR_API_KEY_HERE",
        "timeout_seconds": 10
      },
      "virustotal": {
        "enabled": false,
        "api_key": "PUT_YOUR_API_KEY_HERE",
        "timeout_seconds": 10
      },
      "ipinfo": {
        "enabled": false,
        "api_key": "PUT_YOUR_API_KEY_HERE",
        "timeout_seconds": 10
      }
    },
    "risk_score_weights": {
      "abuseipdb_weight": 0.4,
      "virustotal_weight": 0.35,
      "ipinfo_weight": 0.25
    },
    "threat_level_thresholds": {
      "critical": 80,
      "high": 60,
      "medium": 40,
      "low": 0
    }
  },

  "notifications": {
    "enabled": false,
    "providers": {
      "email": {
        "enabled": false,
        "smtp_host": "CHANGE_THIS",
        "smtp_port": 2525,
        "smtp_user": "CHANGE_THIS",
        "smtp_password": "CHANGE_THIS",
        "from_address": "CHANGE_THIS",
        "to_addresses": ["CHANGE_THIS"]
      },
      "slack": {
        "enabled": false,
        "webhook_url": "${SLACK_WEBHOOK_URL}"
      },
      "twilio": {
        "enabled": false,
        "account_sid": "CHANGE_THIS",
        "auth_token": "CHANGE_THIS",
        "from_number": "+1 xxx xxx xxxx",
        "to_numbers": ["+1 xxx xxx xxxx"]
      },
      "webhook": {
        "enabled": false,
        "url": "WEBHOOK_ADDRESS_ENDPOINT_HERE",
        "retry_count": 3,
        "retry_delay_seconds": 5
      }
    },
    "rules": {
      "alert_on_critical": true,
      "alert_on_high": false,
      "alert_on_medium": false,
      "alert_on_low": false
    }
  },

  "dashboard": {
    "enabled": true,
    "listen_addr": ":5601",
    "authentication": {
      "enabled": true,
      "token_header": "X-Dashboard-Token"
    },
    "refresh_interval_seconds": 5,
    "requests_per_minute": 100
  },

  "api": {
    "enabled": true,
    "base_path": "/api",
    "version": "v1",
    "authentication": {
      "enabled": true,
      "token_header": "X-API-Token"
    },
    "rate_limiting": {
      "enabled": true,
      "requests_per_minute": 100
    }
  }
}
