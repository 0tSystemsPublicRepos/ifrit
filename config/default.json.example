{
  "server": {
    "listen_addr": ":8080",
    "proxy_target": "http://localhost:80",
    "api_listen_addr": ":8443",
    "tls": {
      "enabled": true,
      "cert_file": "/app/config/certs/server.crt",
      "key_file": "/app/config/certs/server.key"
    }
  },
  "database": {
    "type": "sqlite",
    "path": "./data/ifrit.db"
  },
  "llm": {
    "primary": "claude",
    "claude": {
      "api_key": "sk-PUT_YOUR_API_KEY_HERE",
      "model": "claude-3-5-haiku-20241022"
    },
    "gpt": {
      "api_key": "",
      "model": "gpt-4o-mini"
    }
  },
  "detection": {
    "mode": "allowlist",
    "enable_local_rules": true,
    "enable_llm": true,
    "llm_only_on": ["POST", "PUT", "DELETE"],
    "whitelist_ips": ["::1"],
    "whitelist_paths": []
  },
  "execution_mode": {
    "mode": "normal",
    "onboarding_auto_whitelist": true,
    "onboarding_duration_days": 7,
    "onboarding_log_file": "./logs/onboarding_traffic.log"
  },
  "anonymization": {
    "enabled": true,
    "strategy": "hybrid",
    "store_original": true,
    "sensitive_headers": ["Authorization", "Cookie", "X-API-Key", "X-Auth-Token"]
  },
  "payload_management": {
    "generate_dynamic_payload": false,
    "dynamic_llm_cache_ttl": 86400,
    "default_responses": {
      "reconnaissance": {
        "content": {"error": "Not found"},
        "status_code": 404
      },
      "sql_injection": {
        "content": {"error": "Forbidden"},
        "status_code": 403
      },
      "xss": {
        "content": {"error": "Invalid input", "message": "XSS prevention enabled"},
        "status_code": 400
      },
      "credential_stuffing": {
        "content": {"error": "Invalid credentials", "message": "Account locked after 3 attempts"},
        "status_code": 401
      },
      "blocked_by_allowlist": {
        "content": {"error": "Forbidden"},
        "status_code": 403
      },
      "fallback": {
        "content": {"error": "Internal server error"},
        "status_code": 500
      }
    }
  },
  "system": {
    "home_dir": "./",
    "log_dir": "./logs",
    "log_level": "info"
  }
}
